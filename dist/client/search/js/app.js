function get_selected_ws(){return state.get("selected")?state.get("selected")[0]:void 0}function removeCards(){cardManager&&cardManager.closeAllCards()}function State(){var a;try{a="localStorage"in window&&null!==window.localStorage}catch(b){a=!1}this.get=function(b){if(!a)return null;var c=localStorage.getItem(b);try{c=JSON.parse(c)}catch(d){return null}return c},this.set=function(b,c){if(!a)return null;try{c=JSON.stringify(c)}catch(d){return null}return localStorage.setItem(b,c)}}var cardManager=void 0,app=angular.module("landing-pages",["dataview","lp-directives","card-directives","social-directives","dashboard-directives","trees-directives","ws-directives","modeling-directives","angular-json-rpc","communities-directives","narrative-directives","ui.router","ngResource","kbaseLogin","ui.bootstrap","search"]).config(["$locationProvider","$stateProvider","$httpProvider","$urlRouterProvider",function(a,b,c,d){c.defaults.useXDomain=!0,delete c.defaults.headers.common["X-Requested-With"],a.html5Mode(!1),b.state("login",{url:"/login/?nextPath",templateUrl:"views/login.html",controller:"Login"}),b.state("narratives",{url:"/narratives/",templateUrl:"views/ws/narratives.html",controller:"WB"}).state("narratives.mynarratives",{url:"my-narratives",templateUrl:"views/ws/narrative-table.html",controller:"WB"}).state("narratives.shared",{url:"shared",templateUrl:"views/ws/narrative-table.html",controller:"WB"}).state("narratives.public",{url:"public",templateUrl:"views/ws/narrative-table.html",controller:"WB"}).state("narratives.featured",{url:"featured",templateUrl:"views/ws/featured.html",controller:"WB"}),b.state("narrativemanager",{url:"/narrativemanager/:action?app&method&copydata&appparam",templateUrl:"views/narrative/narrative-manager.html",controller:"narrativemanager"}),b.state("dataview",{url:"/dataview/:wsid/:objid/:ver?sub&subid",templateUrl:"views/dataview/dataview.html",controller:"Dataview"}).state("dataview2",{url:"/dataview/:wsid/:objid?sub&subid",templateUrl:"views/dataview/dataview.html",controller:"Dataview"}),b.state("ws",{url:"/ws/",templateUrl:"views/ws/ws.html",controller:"WB"}).state("ws.recent",{url:"recent",templateUrl:"views/ws/recent.html",controller:"WB"}).state("ws.id",{url:"objects/:ws?type",templateUrl:"views/ws/objtable.html",controller:"WB"}).state("ws.tour",{url:"tour/",templateUrl:"views/ws/objtable.html",controller:"WBTour"}).state("ws-manage",{url:"/ws/manage",templateUrl:"views/ws/manage.html",controller:"WSManage"}),b.state("analysis",{url:"/analysis/",templateUrl:"views/apps/analysis.html",controller:"Analysis"}).state("analysis.upload",{url:"upload",templateUrl:"views/apps/upload.html",controller:"Upload"}).state("analysis.tasks",{url:"tasks",templateUrl:"views/apps/tasks.html",controller:"Analysis"}).state("analysis.apps",{url:"apps",templateUrl:"views/apps/apps.html",controller:"Analysis"}).state("analysis.builder",{url:"builder",templateUrl:"views/apps/narrative.html",controller:"Analysis"}).state("analysis.objects",{url:"objects",templateUrl:"views/ws/objtable.html",controller:"Analysis"}),b.state("ws.mv",{url:"mv/",templateUrl:"views/ws/mv.html"}).state("ws.mv.model",{url:"model/:ws/:id?fba",templateUrl:"views/ws/model.html",reloadOnSearch:!1}).state("ws.mv.fba",{url:"fba/:ws/:id?fba",templateUrl:"views/ws/data.html",reloadOnSearch:!1}).state("ws.mv.maps",{url:"maps/:ws/:id/?fba",templateUrl:"views/ws/maps.html",reloadOnSearch:!1}).state("ws.mv.modeleditor",{url:"model-editor/:ws/:id/",templateUrl:"views/ws/model-editor.html"}),b.state("ws.models",{url:"models/:ws/:id?map",templateUrl:"views/ws/sortable/model.html",controller:"WBLanding"}).state("ws.fbas",{url:"fbas/:ws/:id",templateUrl:"views/ws/sortable/fba.html",controller:"WBLanding"}).state("ws.etc",{url:"etc/:ws/:id",templateUrl:"views/ws/sortable/etc.html",controller:"WBLanding"}).state("ws.genomes",{url:"genomes/:ws/:id",templateUrl:"views/objects/genome.html",controller:"WBLanding"}).state("ws.media",{url:"media/:ws/:id",templateUrl:"views/ws/sortable/media.html",controller:"WBLanding"}).state("ws.maps",{url:"maps/:ws/:id",templateUrl:"views/ws/sortable/metabolic_map.html",controller:"WBLanding"}).state("ws.provenance",{url:"provenance/:ws/:id",templateUrl:"views/ws/provenance.html",controller:"WBLanding"}).state("ws.json",{url:"json/:ws/:id",templateUrl:"views/ws/json.html",controller:"WBJSON"}).state("ws.pangenome",{url:"pangenome/:ws/:id",templateUrl:"views/ws/sortable/pangenome.html",controller:"WBLanding"}).state("ws.phenotype",{url:"phenotype/:ws/:id",templateUrl:"views/ws/phenotype.html",controller:"WBLanding"}).state("ws.promconstraint",{url:"promconstraint/:ws/:id",templateUrl:"views/ws/promconstraint.html",controller:"WBLanding"}).state("ws.regulome",{url:"regulome/:ws/:id",templateUrl:"views/ws/regulome.html",controller:"WBLanding"}).state("ws.expression_series",{url:"expression_series/:ws/:id",templateUrl:"views/ws/expression_series.html",controller:"WBLanding"}).state("ws.simulation",{url:"simulation/:ws/:id",templateUrl:"views/ws/simulation.html",controller:"WBLanding"}),b.state("ws.metagenome",{url:"metagenome/:ws/:id",templateUrl:"views/ws/objs/metagenome.html",controller:"WBLanding"}).state("ws.collection",{url:"collection/:ws/:id",templateUrl:"views/ws/objs/collection.html",controller:"WBLanding"}).state("ws.profile",{url:"profile/:ws/:id",templateUrl:"views/ws/objs/profile.html",controller:"WBLanding"}),b.state("trees",{url:"/trees/",templateUrl:"views/trees/trees.html",controller:"Trees"}),b.state("rxns",{url:"/rxns",templateUrl:"views/object-list.html",controller:"WSObjects"}).state("rxnsids",{url:"/rxns/:ids",templateUrl:"views/objects/rxn.html",controller:"RxnDetail"}),b.state("cpds",{url:"/cpds",templateUrl:"views/object-list.html",controller:"WSObjects"}).state("cpdsids",{url:"/cpds/:ids",templateUrl:"views/objects/cpd.html",controller:"CpdDetail"}),b.state("models",{url:"/models",templateUrl:"views/object-list.html",controller:"WSObjects"}).state("modelbyid",{url:"/models/:ws/:id",templateUrl:"views/objects/model.html",controller:"ModelDetail"}),b.state("gptype",{url:"/KBaseGwasData.GwasPopulation/:ws/:id",templateUrl:"views/objects/gptype.html",controller:"GPTypeDetail"}).state("gttype",{url:"/KBaseGwasData.GwasPopulationTrait/:ws/:id",templateUrl:"views/objects/gttype.html",controller:"GTTypeDetail"}).state("gvtype",{url:"/KBaseGwasData.GwasPopulationVariation/:ws/:id",templateUrl:"views/objects/gvtype.html",controller:"GVTypeDetail"}).state("ggltype",{url:"/KBaseGwasData.GwasGeneList/:ws/:id",templateUrl:"views/objects/ggltype.html",controller:"GGLTypeDetail"}).state("gpktype",{url:"/KBaseGwasData.GwasPopulationKinship/:ws/:id",templateUrl:"views/objects/gpktype.html",controller:"GGLTypeDetail"}).state("gtvtype",{url:"/KBaseGwasData.GwasTopVariations/:ws/:id",templateUrl:"views/objects/gtvtype.html",controller:"GTVTypeDetail"}),b.state("fbasbyws",{url:"/fbas/:ws",templateUrl:"views/object-list.html",controller:"WSObjects"}).state("fbabyid",{url:"/fbas/:ws/:id",templateUrl:"views/objects/fba.html",controller:"FBADetail"}),b.state("media",{url:"/media",templateUrl:"views/object-list.html",controller:"WSObjects"}).state("mediabyws",{url:"/media/:ws",templateUrl:"views/object-list.html",controller:"WSObjects"}).state("mediabyid",{url:"/media/:ws/:id",templateUrl:"views/objects/media.html",controller:"MediaDetail"}),b.state("genomesbyws",{url:"/genomes/:ws",templateUrl:"views/genomes/sortable-rows-landing-page.html",controller:"WBLanding"}).state("genomesbyid",{url:"/genomes/:ws/:id",templateUrl:"views/genomes/sortable-rows-landing-page.html",controller:"WBLanding"}).state("kbgenomesbyws",{url:"/KBaseGenomes.Genome/:ws",templateUrl:"views/genomes/sortable-rows-landing-page.html",controller:"WBLanding"}).state("kbgenomesbyid",{url:"/KBaseGenomes.Genome/:ws/:id",templateUrl:"views/genomes/sortable-rows-landing-page.html",controller:"WBLanding"}),b.state("kbgenesbyws",{url:"/genes/:ws/:fid",templateUrl:"views/genomes/sortable-rows-landing-page-genes.html",controller:"WBGeneLanding"}).state("kbgenesbywsgenome",{url:"/genes/:ws/:gid/:fid",templateUrl:"views/genomes/sortable-rows-landing-page-genes.html",controller:"WBGeneLanding"}),b.state("meme",{url:"/meme",templateUrl:"views/meme-list.html",controller:"WSObjects"}).state("memebyws",{url:"/meme/:ws",templateUrl:"views/meme-list.html",controller:"WSObjects"}).state("memebyname",{url:"/meme/:ws/:id",templateUrl:"views/objects/meme.html",controller:"MemeDetail"}),b.state("cmonkeybyname",{url:"/cmonkey/:ws/:id",templateUrl:"views/objects/cmonkey.html",controller:"CmonkeyDetail"}),b.state("inferelator",{url:"/inferelator/:ws/:id",templateUrl:"views/objects/inferelator.html",controller:"InferelatorDetail"}),b.state("regprecise",{url:"/regprecise/:ws/:id",templateUrl:"views/objects/regprecise.html",controller:"RegpreciseDetail"}),b.state("mak",{url:"/mak/:ws/:id",templateUrl:"views/genomes/sortable-rows-landing-page-bicluster.html",controller:"MAKDetail"}),b.state("floatdatatable",{url:"/floatdatatable/:ws/:id",templateUrl:"views/genomes/sortable-rows-landing-page-biclusterfloat.html",controller:"FloatDataTable"}),b.state("spec",{url:"/spec/:kind/:id",templateUrl:"views/objects/spec.html",controller:"SpecDetail"}),b.state("wsref",{url:"/ref/:ws/:id",templateUrl:"views/ws/ws-ref-list.html",controller:"WsRefViewer"}).state("wsrefwithversion",{url:"/ref/:ws/:id/:version",templateUrl:"views/ws/ws-ref-list.html",controller:"WsRefViewer"}).state("wsrefusers",{url:"/refusers/:ws/:id",templateUrl:"views/objects/ws-obj-ref-users.html",controller:"WsRefUsersViewer"}).state("wsrefuserswithversion",{url:"/refusers/:ws/:id/:version",templateUrl:"views/objects/ws-obj-ref-users.html",controller:"WsRefUsersViewer"}),b.state("wsobjgraphview",{url:"/objgraphview/:ws",templateUrl:"views/objects/ws-obj-graph-view.html",controller:"WsObjGraphView"}).state("wsobjgraphcenteredview",{url:"/objgraphview/:ws/:id",templateUrl:"views/objects/ws-obj-graph-centered-view.html",controller:"WsObjGraphCenteredView"}),b.state("taxonomyoverview",{url:"/taxon/:taxonname",templateUrl:"views/objects/taxonomy.html",controller:"Taxonomy"}).state("taxonomyinws",{url:"/taxon/:taxonname/:ws",templateUrl:"views/objects/taxonomy.html",controller:"Taxonomy"}),b.state("bambibyid",{url:"/bambi/:ws/:id",templateUrl:"views/objects/bambi.html",controller:"BambiDetail"}),b.state("ppid",{url:"/ppid/:ws/:id",templateUrl:"views/objects/ppid.html",controller:"PPIDetail"}),b.state("landing-pages-help",{url:"/landing-pages-help",templateUrl:"views/landing-pages-help.html",controller:LPHelp}),b.state("tree",{url:"/tree/:ws/:id",templateUrl:"views/objects/tree.html",controller:"TreeDetail"}),b.state("pangenome",{url:"/pangenome/:ws/:id",templateUrl:"views/objects/pangenome.html",controller:"PangenomeDetail"}),b.state("msa",{url:"/msa/:ws/:id",templateUrl:"views/objects/msa.html",controller:"MSADetail"}),b.state("people",{url:"/people/:userid",templateUrl:"views/social/user-page.html",controller:"People"}),b.state("dashboard",{url:"/dashboard",templateUrl:"views/dashboard/dashboard.html",controller:"Dashboard"}),b.state("navtest",{url:"/navtest/:param1",templateUrl:"views/navtest/view.html",controller:"NavTest"}),b.state("narrativestore",{url:"/narrativestore/:type/:id",templateUrl:"views/narrative/narrative-store.html",controller:"NarrativeStore"}),b.state("kidledttype",{url:"/kidledt/:mod/:type",templateUrl:"views/objects/kidledt.html",controller:"KidlEdtDetail"}),b.state("kidledtmod",{url:"/kidledt/:mod",templateUrl:"views/objects/kidledt.html",controller:"KidlEdtDetail"}),b.state("jgi",{url:"/jgi/import/:ws/:obj",templateUrl:"views/jgi/jgi_obj_info.html",controller:"JGI"}),b.state("json",{url:"/json/:ws/:id",templateUrl:"views/objects/json.html",controller:"JsonDetail"}),b.state("contigset",{url:"/contigsets/:ws/:id",templateUrl:"views/objects/contigset.html",controller:"ContigSetDetail"}),d.when("","/login/").when("/","/login/").when("#","/login/"),d.otherwise("/404/"),b.state("404",{url:"*path",templateUrl:"views/404.html"})}]);app.service("userState",function(){var a={token:null,activeNarrative:null,lastNarrative:null,activeWorkspace:null,loggedIn:!1,user_id:null};localStorage.hasOwnProperty("KBaseUserState")||localStorage.setItem("KBaseUserState",JSON.stringify(a));for(var b in a)a.hasOwnProperty(b)&&!localStorage.KBaseUserState.hasOwnProperty(b)&&(localStorage.KBaseUserState[b]=a[b]);return{userState:JSON.parse(localStorage.KBaseUserState),landingPages:JSON.parse("landing_pages.json"),reset:function(){this.userState=JSON.parse(localStorage.KBaseUserState)}}});var kbaseLogin=angular.module("kbaseLogin",[]);kbaseLogin.factory("kbaseLogin",function(){return $("#signin-button").kbaseLogin()}),configJSON=$.parseJSON($.ajax({url:"config.json",async:!1,dataType:"json"}).responseText);var currentConfig=configJSON[configJSON.setup];$.ajaxSetup({timeout:currentConfig.kbase_clients.defaults.timeout}),app.run(function(a,b,c,d){a.$on("$locationChangeStart",function(a){var c=d.absUrl(),e=c.indexOf("/functional-site/"),f="/functional-site/".length;c.indexOf("/functional-site/#/")<0&&e>0&&c.length>e+f&&(a.preventDefault(),b.go("404",null,{location:!1}))}),a.$on("$stateChangeSuccess",function(){$("body").not("#project-table tr").unbind("click"),$(".fixedHeader").remove(),$(".popover").remove(),removeCards()}),$("#signin-button").kbaseLogin(),postal.channel("session").subscribe("login.success",function(b){var c=new KBCacheClient(b.session.getAuthToken());a.kb=c,window.kb=c,b.nextPath&&"/login/"!==b.nextPath?d.url(b.nextPath):b.nextURL?window.location.href=b.nextURL:d.url("/dashboard"),a.$apply()}),postal.channel("loginwidget").subscribe("login.prompt",function(){var c=d.url(),e="/login/",f={};c&&(f.nextPath=c,e+="?nextPath="+encodeURIComponent(c)),b.go("login",f),a.$apply()}),postal.channel("session").subscribe("logout.request",function(a){require(["kb.session","postal"],function(a,b){a.logout().then(function(){b.channel("session").publish("logout.success")})["catch"](function(a){console.error("Error"),console.error(a)}).done()})}.bind(this)),postal.channel("session").subscribe("logout.success",function(b){var c=new KBCacheClient(null);a.kb=c,window.kb=c,window.location="/"}),USER_ID=$("#signin-button").kbaseLogin("get_session_prop","user_id"),USER_TOKEN=$("#signin-button").kbaseLogin("get_session_prop","token"),kb=new KBCacheClient(USER_TOKEN),a.USER_ID="undefined"==typeof USER_ID?!1:USER_ID,state=new State,a.$state=b,a.$stateParams=c,a.kb=kb,a.Object=Object,require(["kb.widget.navbar"],function(b){a.$on("$locationChangeSuccess",function(a,c,d){c!==d&&(b.clear().addDefaultMenu({search:!0,narrative:!0}),$(document).find("head title").text("Narrative Interface | KBase")),postal.channel("app").publish("location.change")}),a.$apply()}),require(["kb.appstate"],function(a){})}),function(a,b,c){"use strict";var d,e;if(a.uaMatch=function(a){a=a.toLowerCase();var b=/(opr)[\/]([\w.]+)/.exec(a)||/(chrome)[ \/]([\w.]+)/.exec(a)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[],c=/(ipad)/.exec(a)||/(iphone)/.exec(a)||/(android)/.exec(a)||/(windows phone)/.exec(a)||/(win)/.exec(a)||/(mac)/.exec(a)||/(linux)/.exec(a)||[];return{browser:b[3]||b[1]||"",version:b[2]||"0",platform:c[0]||""}},d=a.uaMatch(b.navigator.userAgent),e={},d.browser&&(e[d.browser]=!0,e.version=d.version,e.versionNumber=parseInt(d.version)),d.platform&&(e[d.platform]=!0),(e.chrome||e.opr||e.safari)&&(e.webkit=!0),e.rv){var f="msie";d.browser=f,e[f]=!0}if(e.opr){var g="opera";d.browser=g,e[g]=!0}if(e.safari&&e.android){var h="android";d.browser=h,e[h]=!0}e.name=d.browser,e.platform=d.platform,a.browser=e}(jQuery,window);