angular.module("lp-directives",[]),angular.module("lp-directives").directive("objectlist",function(a){return{link:function(b,c,d){if("models"==b.type){var e=b.ws?b.ws:"KBaseCDMModels",f=$(c).kbasePanel({title:"KBase Models",rightLabel:e});f.loading();var g=kb.req("ws","list_workspace_objects",{type:"Model",workspace:e});$.when(g).done(function(c){$(f.body()).kbaseWSModelTable({ws:e,data:c}),$(document).on("modelClick",function(c,d){var f="/models/"+e+"/"+d.id;b.$apply(a.path(f))})})}else if("media"==b.type){var e=b.ws?b.ws:"KBaseMedia",f=$(c).kbasePanel({title:"KBase Media",rightLabel:e});f.loading();var g=kb.req("ws","list_workspace_objects",{type:"Media",workspace:e});$.when(g).done(function(d){$(c).kbaseWSMediaTable({ws:e,data:d}),$(document).on("mediaClick",function(c,d){var f="/media/"+e+"/"+d.id;b.$apply(a.path(f))})})}else if("rxns"==b.type){var f=$(c).kbasePanel({title:"Biochemistry Reactions"});f.loading();var h=$(f.body()).kbaseBioRxnTable(),g=getBio("rxns",f.body(),function(a){h.loadTable(a)})}else if("cpds"==b.type){var f=$(c).kbasePanel({title:"Biochemistry Compounds"});f.loading();var h=$(f.body()).kbaseBioCpdTable(),g=getBio("cpds",f.body(),function(a){h.loadTable(a)})}}}}).directive("memelist",function(a){return{link:function(b,c,d){var e=b.ws?b.ws:"AKtest";$(c).kbaseMemeTable({ws:e,auth:b.USER_TOKEN,userId:b.USER_ID}),$(document).on("memeClick",function(c,d){var f="/meme/"+e+"/"+d.id;b.$apply(a.path(f))})}}}).directive("modelmeta",function(){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Model Info",rightLabel:a.ws,subText:a.id});d.loading();var e=kb.req("ws","get_objectmeta",{type:"Model",id:a.id,workspace:a.ws});$.when(e).done(function(a){$(d.body()).kbaseModelMeta({data:a})})}}}).directive("modeltabs",function(a,b){return{link:function(c,d,e){var f=c.ws;c.id;$(d).loading();var g=kb.get_model(c.ws,c.id);$.when(g).done(function(e){$(d).rmLoading(),b.org_name=e[0].data.name,c.$apply(),$(d).kbaseModelTabs({modelsData:e,api:kb.fba,ws:f}),$(document).on("rxnClick",function(b,d){var e="/rxns/"+d.ids;c.$apply(a.path(e))}),$(document).on("cpdClick",function(b,d){var e="/cpds/"+d.ids;c.$apply(a.path(e))})}).fail(function(a){$(d).rmLoading(),$(d).append('<div class="alert alert-danger">'+a.error.message+"</div>")})}}}).directive("modelcore",function(a){return{link:function(b,c,d){var e=b.ws,f=b.id,g=$(c).kbasePanel({title:"Core Metabolic Pathway",rightLabel:e,subText:f,type:"FBAModel",widget:"modelcore"});g.loading();var h=kb.req("fba","get_models",{models:[f],workspaces:[e]});$.when(h).done(function(c){$(g.body()).kbaseModelCore({ids:[f],workspaces:[e],modelsData:c}),$(document).on("coreRxnClick",function(c,d){var e="/rxns/"+d.ids.join("&");b.$apply(a.path(e))})})}}}).directive("modelopts",function(){return{link:function(a,b,c){$(b).kbaseModelOpts({ids:a.id,workspaces:a.ws})}}}).directive("fbameta",function(){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"FBA Info",rightLabel:a.ws,subText:a.id});d.loading();var e=kb.req("ws","get_objectmeta",{type:"FBA",id:a.id,workspace:a.ws});$.when(e).done(function(a){$(d.body()).kbaseFbaMeta({data:a})})}}}).directive("models",function(a,b,c){return{link:function(a,b,d){b.kbaseModelTabs({ws:c.ws,name:c.id})}}}).directive("fbas",function(a,b,c){return{link:function(a,b,d){b.kbaseFbaTabs({ws:c.ws,name:c.id})}}}).directive("fbatabs",function(a,b,c){return{link:function(d,e,f){function g(a){if(a.length){var b=h(a);$(e).prepend(b),i(a[0].ws,a[0].name)}else $(e).rmLoading(),$(e).html(j)}function h(a){var b=$('<select class="form-control fba-selector">');for(var d in a){var e=a[d];c.fba==e.name?b.append('<option data-name="'+e.name+'" data-ws="'+e.ws+'" selected>'+e.name+" | "+e.ws+" | "+e.date+"</option>"):b.append('<option data-name="'+e.name+'" data-ws="'+e.ws+'">'+e.name+" | "+e.ws+" | "+e.date+"</option>")}b.change(function(){var a=$("<div>");$(this).after(a),a.loading();var b=$(this).find("option:selected"),c=b.data("name"),d=b.data("ws");i(d,c)});var f=$('<div class="col-xs-5">');f.append(b);var g=$('<div class="row">');return g.append(f),g}function i(c,f){var g=kb.get_fba(c,f);$.when(g).done(function(c){$(e).rmLoading(),$(".fba-container").remove();var f=$('<div class="fba-container">');$(e).append(f),f.kbaseFbaTabs({fbaData:c}),b.org_name=c[0].org_name,d.$apply(),$(document).on("rxnClick",function(b,c){var e="/rxns/"+c.ids;d.$apply(a.path(e))}),$(document).on("cpdClick",function(b,c){var e="/cpds/"+c.ids;d.$apply(a.path(e))})})}$(e).loading();var j="<h5>There are currently no FBA results associated with this model. You may want to run FBA analysis.</h5>";$.when(d.ref_obj_prom).done(function(){g(d.fba_refs)}).fail(function(){$(e).html(j)})}}}).directive("associatedmodel",function(a){return{link:function(b,c,d){var e=b.id;$(c).loading();var f=kb.ws.get_referenced_objects([b.ws+"/"+b.id]);$.when(f).done(function(a){console.log("data",a)});var g=kb.get_fba(b.ws,b.id);$.when(g).done(function(d){var f=d[0].obj_refs,g=[];for(var h in f)g.push({ref:f[h]});var i=kb.ws.get_object_info(g);$.when(i).done(function(){var d=arguments[0];for(var f in d){var g=d[f],h=g[2],i=h.slice(h.indexOf(".")+1),j=i.split("-")[0];if("FBAModel"==j){var k=g[7],l=g[1];break}}var m="ws.mv.fba({ws:'"+k+"', id:'"+l+"', fba:'"+e+"'})",n=$('<h5><a ui-sref="'+m+'">'+e+"</a></h5>");a(n)(b),$(c).append(n),$(c).append("<br><br>"),$(c).append("<h5>Referenced Objects</h5>");var o=[],p=[];$(c).rmLoading();for(var f in d){var g=d[f],h=g[2],k=g[7],l=g[1],i=(h.split(".")[0],h.slice(h.indexOf(".")+1)),j=i.split("-")[0];switch(j){case"FBA":route="ws.fbas";break;case"FBAModel":route="ws.mv.model";break;case"Media":route="ws.media";break;case"MetabolicMap":route="ws.maps";break;case"Media":route="ws.media"}var m=route+"({ws:'"+k+"', id:'"+l+"'})",n='<a ui-sref="'+m+'">'+l+"</a>";o.push(n),p.push(j)}var q=kb.ui.listTable({array:o,labels:p});a(q)(b),$(c).append(q)})})}}}).directive("fbacore",function(a){return{link:function(b,c,d){var e=$(c).kbasePanel({title:"Core Metabolic Pathway",rightLabel:b.ws,subText:b.id,type:"FBA",widget:"fbacore"});e.loading();var f=kb.req("fba","get_fbas",{fbas:[b.id],workspaces:[b.ws]});$.when(f).done(function(c){var d=c[0].modelref,f=parseInt(d.split("/")[0]),g=parseInt(d.split("/")[1]),h=kb.req("fba","get_models",{models:[g],workspaces:[f]});$.when(h).done(function(d){$(e.body()).kbaseModelCore({ids:[b.id],workspaces:[b.ws],modelsData:d,fbasData:c}),$(document).on("coreRxnClick",function(c,d){var e="/rxns/"+d.ids.join("&");b.$apply(a.path(e))})})})}}}).directive("fbapathways",function(a){return{link:function(a,b,c){var d="nconrad:paths",e=$(b).kbasePanel({title:"Pathways",type:"Pathway",rightLabel:d,subText:a.id});e.loading();var f=kb.get_models(a.ws,a.id);$.when(f).done(function(b){$(e.body()).pathways({fbaData:b,ws:d,defaultMap:a.defaultMap,scope:a})}).fail(function(a){$(e.body()).append('<div class="alert alert-danger">'+a.error.message+"</div>")})}}}).directive("pathway",function(){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Metabolic Pathway",type:"Pathway",rightLabel:"N/A",subText:a.id});d.loading();var e=kb.req("ws","get_objects",[{name:a.id,workspace:a.ws}]);$.when(e).done(function(b){var b=b[0].data;$(d.body()).kbasePathway({ws:a.ws,mapID:a.id,mapData:b,editable:!0})}).fail(function(a){$(d.body()).append('<div class="alert alert-danger">'+a.error.message+"</div>")})}}}).directive("mediadetail",function(){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Media Details",type:"Media",rightLabel:a.ws,subText:a.id,widget:"mediadetail"});d.loading();var e=kb.req("fba","get_media",{medias:[a.id],workspaces:[a.ws]});$.when(e).done(function(b){$(d.body()).kbaseMediaEditor({ids:[a.id],workspaces:[a.ws],data:b})}).fail(function(a){$(b).rmLoading(),$(b).append('<div class="alert alert-danger">'+a.error.message+"</div>")})}}}).directive("phenotype",function(){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Phenotype Set Data",rightLabel:a.ws,subText:a.id});$(d.body()).kbasePhenotypeSet({ws:a.ws,name:a.id})}}}).directive("promconstraint",function(){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"PROM Constraint Data",rightLabel:a.ws,subText:a.id});$(d.body()).kbasePromConstraint({ws:a.ws,name:a.id})}}}).directive("regulome",function(){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Regulome Data",rightLabel:a.ws,subText:a.id});$(d.body()).kbaseRegulome({ws:a.ws,name:a.id})}}}).directive("expressionseries",function(){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Expression Series",rightLabel:a.ws,subText:a.id});$(d.body()).kbaseExpressionSeries({ws:a.ws,name:a.id})}}}).directive("pangenome",function(){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Pangenome ",rightLabel:a.ws,subText:a.id});d.loading(),$(d.body()).kbasePanGenome({ws:a.ws,name:a.id})}}}).directive("simulation",function(){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Simulation Set Data",rightLabel:a.ws,subText:a.id});d.loading(),$(d.body()).kbaseSimulationSet({ws:a.ws,name:a.id})}}}).directive("rxndetail",function(){return{link:function(a,b,c){for(var d=a.ids,e=$(b).kbTabs(),f=0;f<d.length;f++){var g=d[f],h=$("<div>");h.kbaseRxn({id:g}),e.addTab({name:d[f],content:h,active:0==f?!0:!1,animate:!1})}}}}).directive("cpddetail",function(){return{link:function(a,b,c){for(var d=a.ids,e=$(b).kbTabs(),f=0;f<d.length;f++){var g=d[f],h=$("<div>");h.kbaseCpd({id:g}),e.addTab({name:d[f],content:h,active:0==f?!0:!1,animate:!1})}}}}).directive("jsonviewer",function(){return{link:function(a,b,c){function d(a){$(b).append("<h3>Metadata</h3><br>");var c=$('<div id="metadata">');$(b).append(c),c.JSONView(JSON.stringify(a.metadata)),$(b).append("<h3>Data</h3><br>");var c=$('<div id="data">');$(b).append(c),c.JSONView(JSON.stringify(a.data))}$(b).append("<b>Sorry!</b>  No landing page is available for this object.                             In the meantime, view the JSON below or consider contributing."),$(b).loading();var e=kb.req("ws","get_object",{workspace:a.ws,id:a.id});$.when(e).done(function(c){var c=c;$(b).rmLoading(),a.data=c,d(c)}).fail(function(a){$(b).rmLoading(),$(b).append('<div class="alert alert-danger">'+a.error.message+"</div>")})}}}).directive("backbutton",function(){return{link:function(a,b,c){$(b).on("click",function(){window.history.back()})}}}).directive("genomeoverview",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Genome Overview",rightLabel:a.ws,subText:a.id});d.loading(),$(d.body()).KBaseGenomeOverview({genomeID:a.id,workspaceID:a.ws,kbCache:kb})}}}).directive("genomewiki",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Genome Wiki",rightLabel:a.ws,subText:a.id});d.loading(),$(d.body()).KBaseWikiDescription({genomeID:a.id,workspaceID:a.ws,kbCache:kb})}}}).directive("sortablegenomeoverview",function(a){return{link:function(a,b,c){"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3");var d=$(b).kbasePanel({title:"Overview",rightLabel:a.ws,subText:a.id});d.loading(),$(d.body()).KBaseGenomeWideOverview({genomeID:a.id,workspaceID:a.ws,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortableimport",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Copy To My Workspace",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseWSButtons({objNameOrId:a.id,wsNameOrId:a.ws})}}}).directive("sortablegenometaxonomy",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Taxonomy",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseGenomeWideTaxonomy({genomeID:a.id,workspaceID:a.ws,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortabletaxonomyinfo",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Taxonomy",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseGenomeLineage({genomeID:a.id,workspaceID:a.ws,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortabletree",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Species Tree",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3")}}}).directive("sortablegenomeassemannot",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Assembly and Annotation",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseGenomeWideAssemAnnot({genomeID:a.id,workspaceID:a.ws,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablecontigbrowser",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Contig Browser",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseMultiContigBrowser({genomeID:a.id,workspaceID:a.ws,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablegenetable",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Gene List",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseGenomeGeneTable({genome_id:a.id,ws_name:a.ws,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortableseedannotations",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Functional Categories",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseSEEDFunctions({objNameOrId:a.id,wsNameOrId:a.ws,objVer:null,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablegenomecompleteness",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Genome Completeness",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseGenomeCompleteness({genome_id:a.id,ws_name:a.ws,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablerelatedpublications",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Related Publications",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3");var e=a.ws+"/"+a.id;kb.ws.get_object_subset([{ref:e,included:["/scientific_name"]}],function(a){var b="";a[0]&&a[0].data.scientific_name&&(b=a[0].data.scientific_name),$(d.body()).KBaseLitWidget({literature:b,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})},function(a){console.error("Trying to get scientific name for genome for related publication widget"),console.error(a),$(d.body()).KBaseLitWidget({literature:"",kbCache:kb})})}}}).directive("sortablenarrativereflist",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Narratives using this Genome",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseNarrativesUsingData({objNameOrId:a.id,wsNameOrId:a.ws,objVer:null,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortableuserreflist",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"People using this Genome",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseWSObjRefUsers({objNameOrId:a.id,wsNameOrId:a.ws,objVer:null,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablereferencelist",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"List of data objects referencing this Genome",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseWSReferenceList({objNameOrId:a.id,wsNameOrId:a.ws,objVer:null,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortableobjrefgraphview",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Object Reference and Provenance Graph",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseWSObjGraphCenteredView({objNameOrId:a.id,wsNameOrId:a.ws,kbCache:kb})}}}).directive("sortablegenomecommunity",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"KBase Community",rightLabel:a.ws,subText:a.id});d.loading(),"CDS"===a.ws&&(a.ws="KBasePublicGenomesV3"),$(d.body()).KBaseGenomeWideCommunity({genomeID:a.id,workspaceID:a.ws,kbCache:kb})}}}).directive("sortablegenomepage",function(a){return{link:function(a,b,c){$(b).KBaseGenomePage({genomeID:a.id,workspaceID:a.ws})}}}).directive("sortablegeneoverview",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Gene Overview",rightLabel:a.ws,subText:a.fid});d.loading(),$(d.body()).KBaseGeneInstanceInfo({featureID:a.fid,genomeID:a.gid,workspaceID:a.ws,kbCache:kb,hideButtons:!0,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablegenecontigbrowser",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Contig Location",rightLabel:a.ws,subText:a.fid});d.loading(),$(d.body()).KBaseContigBrowser({centerFeature:a.fid,genomeId:a.gid,workspaceId:a.ws,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablebiochemistry",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Biochemistry",rightLabel:a.ws,subText:a.fid});d.loading(),$(d.body()).KBaseGeneBiochemistry({featureID:a.fid,genomeID:a.gid,workspaceID:a.ws,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablesequence",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Sequence",rightLabel:a.ws,subText:a.fid});d.loading(),$(d.body()).KBaseGeneSequence({featureID:a.fid,genomeID:a.gid,workspaceID:a.ws,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablegenedomains",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Domains",rightLabel:a.ws,subText:a.fid});d.loading(),$(d.body()).KBaseGeneDomains({featureID:a.fid,genomeID:a.gid,workspaceID:a.ws,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablepdbstructure",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Structure",rightLabel:a.ws,subText:a.fid});d.loading(),$(d.body()).KBaseGeneStructureMatches({featureID:a.fid,genomeID:a.gid,workspaceID:a.ws,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortableexprlineplot",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Gene Expression Data",rightLabel:a.ws,subText:a.fid});d.loading(),$(d.body()).KBaseGeneExprLinePlot({featureID:a.fid,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablegenetree",function(a){return{link:function(a,b,c){var d=$(b).kbasePanel({title:"Gene Tree",rightLabel:a.ws,subText:a.fid});if(d.loading(),"CDS"===a.ws)return $(d.body()).empty(),void $(d.body()).append("<b>There are no gene trees created for this gene.</b>");var e=a.ws,f=a.gid,g=a.fid;$(d.body()).empty(),$(d.body()).append("Object ref: "+e+"/"+f+"/"+g+"<br>");var h=f+"/"+g;kb.ws.list_objects({workspaces:[e],type:"KBaseTrees.Tree",includeMetadata:1},function(b){var c=[];for(var f in b){var g=b[f];if("SpeciesTree"!==g[10].type){var i=g[1];if(c.push({ref:e+"/"+i,included:["default_node_labels"]}),c.length>100)break}}0==c.length?($(d.body()).empty(),$(d.body()).append("<b>There are no gene trees created for this gene.</b>")):kb.ws.get_object_subset(c,function(b){var c=null;for(var e in b){for(var f in b[e].data.default_node_labels){var g=b[e].data.default_node_labels[f];if(g===h){c=b[e].info[1];break}}if(c)break}c?($(d.body()).empty(),$(d.body()).kbaseTree({treeID:c,workspaceID:a.ws})):($(d.body()).empty(),$(d.body()).append("<b>There are no gene trees created for this gene.</b>"))},function(a){var b="<b>Sorry!</b>  Error retreiveing species trees info";"string"==typeof a?b+=": "+a:a.error&&a.error.message&&(b+=": "+a.error.message),$(d.body()).empty(),$(d.body()).append(b)})},function(a){var b="<b>Sorry!</b>  Error retreiveing species trees info";"string"==typeof a?b+=": "+a:a.error&&a.error.message&&(b+=": "+a.error.message),$(d.body()).empty(),$(d.body()).append(b)})}}}).directive("sortablegenepage",function(a){return{link:function(a,b,c){$(b).KBaseGenePage({featureID:a.fid,genomeID:a.gid,workspaceID:a.ws})}}}).directive("sortablemakresult",function(a){return{link:function(b,c,d){"CDS"===b.params.workspace&&(b.params.workspace="KBaseBicluster");var e=$(c).kbasePanel({title:"Bicluster Set Overview",rightLabel:b.params.workspace,subText:b.params.id});e.loading(),$(e.body()).KBaseMAKResultCard({id:b.params.id,workspace:b.params.workspace,auth:a.USER_TOKEN,userId:a.USER_ID,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablemaktiles",function(a){return{link:function(b,c,d){"CDS"===b.params.workspace&&(b.params.workspace="KBaseBicluster");var e=$(c).kbasePanel({title:"Bicluster Set Tiles",rightLabel:b.params.workspace,subText:b.params.id});e.loading(),$(e.body()).KBaseMAKTilingCard({id:b.params.id,workspace:b.params.workspace,scope:b,auth:a.USER_TOKEN,userId:a.USER_ID,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("sortablemakterms",function(a){return{link:function(b,c,d){"CDS"===b.params.workspace&&(b.params.workspace="KBaseBicluster");var e=$(c).kbasePanel({title:"Bicluster Set Enriched Terms",rightLabel:b.params.workspace,subText:b.params.id}),f=new Workspace("https://kbase.us/services/ws",{token:a.USER_TOKEN,user_id:a.USER_ID});$.when(f.get_objects([{workspace:b.params.workspace,name:b.params.id}])).then(function(c){var d=c[0].data.sets[0].biclusters,f={};for(i=0;i<d.length;i++){var g=[];for(var h in d[i].enriched_terms)if(""!=d[i].enriched_terms[h]){g.push(d[i].enriched_terms[h]);var j=h+": "+d[i].enriched_terms[h];j in f?f[j].push(d[i].bicluster_id):f[j]=[d[i].bicluster_id]}}e.loading(),$(e.body()).KBaseBarChartCard({terms:f,workspace:b.params.workspace,auth:a.USER_TOKEN,userId:a.USER_ID,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})})}}}).directive("sortablemakbicluster",function(a){return{link:function(b,c,d){"CDS"===b.params.workspace&&(b.params.workspace="KBaseBicluster");var e=new Workspace("https://kbase.us/services/ws",{token:a.USER_TOKEN,user_id:a.USER_ID});$.when(e.get_objects([{workspace:b.params.workspace,name:b.params.id}])).then(function(d){var e=d[0].data.sets[0].biclusters,f=d[0].data.sets[0];b.params.id=e[0].bicluster_id,$("body").on("click",".biclusterTile",function(){b.params.id=e[$(this).val()].bicluster_id,g.header()[0].childNodes[6].childNodes[0].data=e[$(this).val()].bicluster_id,g.loading(),h.options.bicluster=[e,$(this).val(),f],h.__proto__.render(h.options,h),$(g.body()).KBaseMAKBiclusterCard({bicluster:[e,$(this).val(),f],workspace:b.params.workspace,auth:a.USER_TOKEN,userId:a.USER_ID,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})});var g=$(c).kbasePanel({title:"Bicluster Overview",rightLabel:b.params.workspace,subText:b.params.id});g.loading();var h=$(g.body()).KBaseMAKBiclusterCard({bicluster:[e,0,f],workspace:b.params.workspace,auth:a.USER_TOKEN,userId:a.USER_ID,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})})}}}).directive("floatheatmap",function(a){return{link:function(b,c,d){"CDS"===b.params.workspace&&(b.params.workspace="KBaseBicluster");var e=new Workspace("https://kbase.us/services/ws",{token:a.USER_TOKEN,user_id:a.USER_ID});$.when(e.get_objects([{workspace:b.params.workspace,name:b.params.id}])).then(function(d){var e=d[0].data;b.params.id=e.id;var f=$(c).kbasePanel({title:"Data Table",rightLabel:b.params.workspace,subText:b.params.id});f.loading();$(f.body()).KBaseHeatMapCard({count:e.id.replace(/\./g,"").replace(/\|/,""),bicluster:d[0].data,workspace:b.params.workspace,auth:a.USER_TOKEN,userId:a.USER_ID,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})})}}}).directive("floatlinechart",function(a){return{link:function(b,c,d){"CDS"===b.params.workspace&&(b.params.workspace="KBaseBicluster");var e=new Workspace("https://kbase.us/services/ws",{token:a.USER_TOKEN,user_id:a.USER_ID});$.when(e.get_objects([{workspace:b.params.workspace,name:b.params.id}])).then(function(d){var e=d[0].data;b.params.id=e.id;var f,g,h=null,i=e.row_labels,j=e.column_labels,k=e.data,l=!0;$("body").on("click",".geneLabel"+e.id.replace(/\./g,"").replace(/\|/,""),function(){h=$(this).index(),l&&(g=$(c).kbasePanel({title:"Line Chart",rightLabel:b.params.workspace,subText:b.params.id}),g.loading(),f=$(g.body()).KBaseLineChartCard({id:b.params.id.replace(/\./g,"").replace(/\|/,""),count:e.id.replace(/\./g,"").replace(/\|/,""),row:[k,j,i,h],workspace:b.params.workspace,auth:a.USER_TOKEN,userId:a.USER_ID,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"}),l=!1)})})}}}).directive("sortableheatmap",function(a){return{link:function(b,c,d){"CDS"===b.params.workspace&&(b.params.workspace="KBaseBicluster");var e=new Workspace("https://kbase.us/services/ws",{token:a.USER_TOKEN,user_id:a.USER_ID});$.when(e.get_objects([{workspace:b.params.workspace,name:b.params.id}])).then(function(d){var f=d[0].data.sets[0].biclusters;d[0].data.sets[0];b.params.id=f[0].bicluster_id,$.when(e.get_objects([{workspace:b.params.workspace,name:b.params.id}])).then(function(d){$("body").on("click",".biclusterTile",function(){b.params.id=f[$(this).val()].bicluster_id,g.header()[0].childNodes[6].childNodes[0].data=f[$(this).val()].bicluster_id,g.loading(),$.when(e.get_objects([{workspace:b.params.workspace,name:b.params.id}])).then(function(c){var d=c[0].data;h.options.bicluster=d,h.options.count=d.id.replace(/\./g,"").replace(/\|/,""),h.$elem.empty(),h.render(h.options,h),$(g.body()).KBaseHeatMapCard({count:f[0].bicluster_id.replace(/\./g,"").replace(/\|/,""),bicluster:c[0].data,workspace:b.params.workspace,auth:a.USER_TOKEN,userId:a.USER_ID,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})})});var g=$(c).kbasePanel({title:"Data Table",rightLabel:b.params.workspace,subText:b.params.id});g.loading();var h=$(g.body()).KBaseHeatMapCard({count:f[0].bicluster_id.replace(/\./g,"").replace(/\|/,""),bicluster:d[0].data,workspace:b.params.workspace,auth:a.USER_TOKEN,userId:a.USER_ID,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"})})})}}}).directive("sortablelinechart",function(a){return{link:function(b,c,d){"CDS"===b.params.workspace&&(b.params.workspace="KBaseBicluster");var e=new Workspace("https://kbase.us/services/ws",{token:a.USER_TOKEN,user_id:a.USER_ID});$.when(e.get_objects([{workspace:b.params.workspace,name:b.params.id}])).then(function(d){var f=d[0].data.sets[0].biclusters;d[0].data.sets[0];b.params.id=f[0].bicluster_id,$.when(e.get_objects([{workspace:b.params.workspace,name:b.params.id}])).then(function(d){var g=d[0].data;$("body").on("click",".biclusterTile",function(){b.params.id=f[$(this).val()].bicluster_id,$.when(e.get_objects([{workspace:b.params.workspace,name:b.params.id}])).then(function(c){var d=c[0].data,e=null,f=d.row_labels,g=d.column_labels,h=d.data,i=!0;$("body").on("click",".geneLabel"+d.id.replace(/\./g,"").replace(/\|/,""),function(){if(e=$(this).index(),i){var c=$("<div sortablelinechart>");$("#sortable-landing").append($("<div class='col-md-12'>").append(c));var j=c.kbasePanel({title:"Line Chart",rightLabel:b.params.workspace,subText:b.params.id});j.loading(),$(j.body()).KBaseLineChartCard({id:b.params.id.replace(/\./g,"").replace(/\|/,""),count:d.id.replace(/\./g,"").replace(/\|/,""),row:[h,g,f,e],workspace:b.params.workspace,auth:a.USER_TOKEN,userId:a.USER_ID,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"}),i=!1}})})});var h,i,j=null,k=g.row_labels,l=g.column_labels,m=g.data,n=!0;$("body").on("click",".geneLabel"+g.id.replace(/\./g,"").replace(/\|/,""),function(){j=$(this).index(),n&&(i=$(c).kbasePanel({title:"Line Chart",rightLabel:b.params.workspace,subText:b.params.id}),i.loading(),h=$(i.body()).KBaseLineChartCard({id:b.params.id.replace(/\./g,"").replace(/\|/,""),count:f[0].bicluster_id.replace(/\./g,"").replace(/\|/,""),row:[m,l,k,j],workspace:b.params.workspace,auth:a.USER_TOKEN,userId:a.USER_ID,kbCache:kb,loadingImage:"assets/img/ajax-loader.gif"}),n=!1)})})})}}}).directive("jgiobjinfo",function(a){return{link:function(a,b,c){var d=$('<div class="panel panel-default"><div class="panel-heading"><span class="panel-title"></span></div><div class="panel-body"></div></div>');$(b).append(d).css({margin:"10px"}),d.find(".panel-title").append("Imported JGI Data"),d.find(".panel-body").KBaseJgiDataImportView({ws:a.params.ws,obj:a.params.obj,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("narrativestore",function(a){return{link:function(a,b,c){var d=$('<div class="panel panel-default"><div class="panel-heading"><span class="panel-title"></span></div><div class="panel-body"></div></div>').css({margin:"10px"});$(b).append(d),d.find(".panel-title").append("Narrative Apps and Methods Documentation"),d.find(".panel-body").KBaseNarrativeStoreView({type:a.params.type,id:a.params.id,loadingImage:"assets/img/ajax-loader.gif"})}}}).directive("jsoncards",function(a){return{link:function(a,b,c){var d=$('<div class="panel panel-default"><div class="panel-heading"><span class="panel-title"></span></div><div class="panel-body"></div></div>').css({margin:"10px"});$(b).append(d),d.find(".panel-title").append("Raw Data JSON Viewer"),d.find(".panel-body").kbaseJsonView({ws:a.params.ws,id:a.params.id})}}});