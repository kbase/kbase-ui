function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b="[\\?&]"+a+"=([^&#]*)",c=new RegExp(b),d=c.exec(window.location.search);return null==d?"":decodeURIComponent(d[1].replace(/\+/g," "))}angular.module("iris-directives",[]),angular.module("iris-directives").directive("processlist",function(a){return{link:function(b,c,d,e){a.plist=$(c).kbaseIrisProcessList(),a.term=$.jqElem("div").kbaseIrisTerminal({promptIfUnauthenticated:0,invocationURL:"http://kbase.us/services/invocation",commandsElement:a.commandlist,grammar:$("<div></div>").kbaseIrisGrammar(),autocreateFileBrowser:!1})}}}).directive("tabs",function(a){return{link:function(b,c,d,e){$(c).kbaseTabs({tabPosition:"bottom",canDelete:!0,tabs:[{tab:"IRIS Terminal",content:a.term.$elem,canDelete:!1}],tabsHeight:parseInt(a.term.terminalHeight())+100+"px"})}}}).directive("commandlist",function(a){return{link:function(b,c,d,e){a.commandlist=$(c),$(c).kbaseIrisCommands({client:a.term.client(),terminal:a.term,englishCommands:!1,overflow:!0,link:function(b){b.preventDefault();var c=$(this).attr("title")+" ";a.term.input_box.val().length&&!a.term.input_box.val().match(/[\|;]\s*$/)&&(c="| "+c),a.term.appendInput(c)}})}}}).directive("filebrowser",function(a){return{link:function(b,c,d,e){var f=$(c).kbaseIrisFileBrowser({client:a.term.client(),invocationURL:a.term.options.invocationURL,addFileCallback:function(b,c){a.term.appendInput(b+" ")},editFileCallback:function(a,b){var c=$.jqElem("div").kbaseIrisFileEditor({file:a,client:b.client(),saveFileCallback:function(a){$tabs.removeTab(a)},cancelSaveFileCallback:function(a){$tabs.removeTab(a)}});$tabs.hasTab(a)?$tabs.showTab(a):$tabs.addTab({tab:a,content:c.$elem,canDelete:!0,show:!0,deleteCallback:function(a){c.savePrompt()}})}});a.term.addFileBrowser(f),a.term.data("processList",a.plist);var g=getParameterByName("command");if(g.length){var h=getParameterByName("signin-button");h.length&&a.term.run("login "+h),setTimeout(function(){a.term.out_cmd(g),a.term.run(g)},200)}}}});