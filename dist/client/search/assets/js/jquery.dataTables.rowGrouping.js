!function(a){"use strict";a.fn.rowGrouping=function(b){function c(){}function d(a,b,c){}function e(a,b,c){}function f(a){var b=["January","February","March","April","May","June","July","August","September","October","November","December"];return b[a-1]}var g={iGroupingColumnIndex:0,sGroupingColumnSortDirection:"",iGroupingOrderByColumnIndex:-1,sGroupingClass:"group",sGroupItemClass:"group-item",bHideGroupingColumn:!0,bHideGroupingOrderByColumn:!0,sGroupBy:"name",sGroupLabelPrefix:"",fnGroupLabelFormat:function(a){return a},bExpandableGrouping:!1,bExpandSingleGroup:!1,iExpandGroupOffset:100,asExpandedGroups:null,sDateFormat:"dd/MM/yyyy",sEmptyGroupLabel:"-",bSetGroupingClassOnTR:!1,iGroupingColumnIndex2:-1,sGroupingColumnSortDirection2:"",iGroupingOrderByColumnIndex2:-1,sGroupingClass2:"subgroup",sGroupItemClass2:"subgroup-item",bHideGroupingColumn2:!0,bHideGroupingOrderByColumn2:!0,sGroupBy2:"name",sGroupLabelPrefix2:"",fnGroupLabelFormat2:function(a){return a},bExpandableGrouping2:!1,fnOnGrouped:c,fnOnGroupCreated:d,fnOnGroupCompleted:e,oHideEffect:null,oShowEffect:null,bUseFilteringForGrouping:!1};return this.each(function(c,d){function e(b,c,d){var e=document.createElement("tr"),f=document.createElement("td");e.id="group-id-"+u.attr("id")+"_"+b;var g={id:e.id,key:b,text:c,level:0,groupItemClass:".group-item-"+b,dataGroup:b,aoSubgroups:new Array};return A.bSetGroupingClassOnTR?e.className=A.sGroupingClass+" "+b:f.className=A.sGroupingClass+" "+b,f.colSpan=d,f.innerHTML=A.sGroupLabelPrefix+A.fnGroupLabelFormat(""==c?A.sEmptyGroupLabel:c,g),A.bExpandableGrouping&&(i(b)?(f.className+=" collapsed-group",g.state="collapsed"):(f.className+=" expanded-group",g.state="expanded"),f.className+=" group-item-expander",a(f).attr("data-group",g.dataGroup),a(f).attr("data-group-level",g.level),a(f).click(s)),e.appendChild(f),v[b]=g,g.nGroup=e,A.fnOnGroupCreated(g,b,1),g}function h(b,c,d,e){var f=document.createElement("tr");f.id=e.id+"_"+b;var g=document.createElement("td"),h=e.dataGroup+"_"+b,j={id:f.id,key:b,text:c,level:e.level+1,groupItemClass:".group-item-"+h,dataGroup:h,aoSubgroups:new Array};return A.bSetGroupingClassOnTR?f.className=A.sGroupingClass2+" "+b:g.className=A.sGroupingClass2+" "+b,g.colSpan=d,g.innerHTML=A.sGroupLabelPrefix2+A.fnGroupLabelFormat2(""==c?A.sEmptyGroupLabel:c,j),A.bExpandableGrouping&&(f.className+=" group-item-"+e.dataGroup),A.bExpandableGrouping&&A.bExpandableGrouping2&&(i(j.dataGroup)?(g.className+=" collapsed-group",j.state="collapsed"):(g.className+=" expanded-group",j.state="expanded"),g.className+=" group-item-expander",a(g).attr("data-group",j.dataGroup),a(g).attr("data-group-level",j.level),a(g).click(s)),f.appendChild(g),e.aoSubgroups[j.dataGroup]=j,v[j.dataGroup]=j,j.nGroup=f,A.fnOnGroupCreated(j,b,2),j}function i(b){return null!=v[b]?"collapsed"==v[b].state:b.indexOf("_")>-1?void 0:!z||null!=y&&0!=y.length?-1==a.inArray(b,y):!1}function j(a){return a.length<w+x?a:a.substr(w,x)}function k(a){return a}function l(a){return a.substr(0,1)}function m(a){return j(a)}function n(a){return a.substr(w,x)+" "+f(a.substr(B,C))}function o(a){return""===a?"-":a.toLowerCase().replace(/[^a-zA-Z0-9\u0080-\uFFFF]+/g,"-")}function p(a,b,c){if(a.nTable.id!==u[0].id)return!0;var d=b[A.iGroupingColumnIndex];return"undefined"==typeof d&&(d=b[a.aoColumns[A.iGroupingColumnIndex].mDataProp]),i(o(d))?(u.fnIsOpen(u.fnGetNodes(c))&&(null!=A.fnOnRowClosed&&A.fnOnRowClosed(this),u.fnClose(u.fnGetNodes(c))),!1):!0}function q(b){return v[b].state="expanded",a("td[data-group^='"+b+"']").removeClass("collapsed-group"),a("td[data-group^='"+b+"']").addClass("expanded-group"),A.bUseFilteringForGrouping?void u.fnDraw():(-1==jQuery.inArray(b,y)&&y.push(b),void(null!=A.oHideEffect?a(".group-item-"+b,u)[A.oShowEffect.method](A.oShowEffect.duration,A.oShowEffect.easing,function(){}):a(".group-item-"+b,u).show()))}function r(b){return v[b].state="collapsed",a("td[data-group^='"+b+"']").removeClass("expanded-group"),a("td[data-group^='"+b+"']").addClass("collapsed-group"),A.bUseFilteringForGrouping?void u.fnDraw():(a(".group-item-"+b).each(function(){u.fnIsOpen(this)&&(null!=A.fnOnRowClosed&&A.fnOnRowClosed(this),u.fnClose(this))}),void(null!=A.oHideEffect?a(".group-item-"+b,u)[A.oHideEffect.method](A.oHideEffect.duration,A.oHideEffect.easing,function(){}):a(".group-item-"+b,u).hide()))}function s(b){var c=a(this).attr("data-group"),d=(a(this).attr("data-group-level"),!i(c));if(A.bExpandSingleGroup){if(!d){var e=a("td.expanded-group").attr("data-group");if(r(e),q(c),-1!=A.iExpandGroupOffset){var f=a("#group-id-"+u.attr("id")+"_"+c).offset().top-A.iExpandGroupOffset;window.scroll(0,f)}else{var f=u.offset().top;window.scroll(0,f)}}}else d?r(c):q(c);b.preventDefault()}function t(b){u.fnSettings().oFeatures.bServerSide&&(z=!0);var c=!1;if(-1!=A.iGroupingColumnIndex2&&(c=!0),0!=b.aiDisplayMaster.length){for(var d=a("tbody tr",u),f=0,g=0;g<b.aoColumns.length;g++)b.aoColumns[g].bVisible&&(f+=1);var j=null,k=null;if(b.aiDisplay.length>0)for(var l=0;l<d.length;l++){var m=b._iDisplayStart+l;u.fnSettings().oFeatures.bServerSide&&(m=l);var n="",p=null,q="",r=null;n=this.fnGetData(d[l],A.iGroupingColumnIndex);var p=n;if("year"!=A.sGroupBy&&(p=D(n)),c&&(q=b.aoData[b.aiDisplay[m]]._aData[A.iGroupingColumnIndex2],void 0==q&&(q=b.aoData[b.aiDisplay[m]]._aData[b.aoColumns[A.iGroupingColumnIndex2].mDataProp]),"year"!=A.sGroupBy2&&(r=D(q))),null==j||o(p)!=o(j)){var s=o(p);null!=j&&A.fnOnGroupCompleted(v[o(j)]),A.bAddAllGroupsAsExpanded&&-1==jQuery.inArray(s,y)&&y.push(s);var t=e(s,p,f),w=t.nGroup;null!=d[l].parentNode?d[l].parentNode.insertBefore(w,d[l]):a(d[l]).before(w),j=p,k=null}if(a(d[l]).attr("data-group",v[s].dataGroup),a(d[l]).addClass(A.sGroupItemClass),a(d[l]).addClass("group-item-"+s),A.bExpandableGrouping&&i(s)&&!A.bUseFilteringForGrouping&&a(d[l]).hide(),c){if(null==k||o(r)!=o(k)){var x=o(p)+"-"+o(r),B=h(x,r,f,v[s]),C=B.nGroup;d[l].parentNode.insertBefore(C,d[l]),k=r}a(d[l]).attr("data-group",B.dataGroup).addClass(A.sGroupItemClass2).addClass("group-item-"+B.dataGroup)}}null!=j&&A.fnOnGroupCompleted(v[o(j)]),A.fnOnGrouped(v),z=!1}}var u=a(d).dataTable(),v=new Array;a(this).dataTableExt.aoGroups=v;var w=6,x=4,y=new Array,z=!0,A=a.extend(g,b);-1==A.iGroupingOrderByColumnIndex?(A.bCustomColumnOrdering=!1,A.iGroupingOrderByColumnIndex=A.iGroupingColumnIndex):A.bCustomColumnOrdering=!0,""==A.sGroupingColumnSortDirection&&("year"==A.sGroupBy?A.sGroupingColumnSortDirection="desc":A.sGroupingColumnSortDirection="asc"),-1==A.iGroupingOrderByColumnIndex2?(A.bCustomColumnOrdering2=!1,A.iGroupingOrderByColumnIndex2=A.iGroupingColumnIndex2):A.bCustomColumnOrdering2=!0,""==A.sGroupingColumnSortDirection2&&("year"==A.sGroupBy2?A.sGroupingColumnSortDirection2="desc":A.sGroupingColumnSortDirection2="asc"),w=A.sDateFormat.toLowerCase().indexOf("yy"),x=A.sDateFormat.toLowerCase().lastIndexOf("y")-A.sDateFormat.toLowerCase().indexOf("y")+1;var B=A.sDateFormat.toLowerCase().indexOf("mm"),C=A.sDateFormat.toLowerCase().lastIndexOf("m")-A.sDateFormat.toLowerCase().indexOf("m")+1,D=k;switch(A.sGroupBy){case"letter":D=l;break;case"year":D=m;break;case"month":D=n;break;default:D=k}if(null!=A.asExpandedGroups){if("NONE"==A.asExpandedGroups)A.asExpandedGroups=[],y=A.asExpandedGroups,z=!1;else if("ALL"==A.asExpandedGroups)A.bAddAllGroupsAsExpanded=!0;else if(A.asExpandedGroups.constructor==String){var E=A.asExpandedGroups;A.asExpandedGroups=new Array,A.asExpandedGroups.push(o(E)),y=A.asExpandedGroups,z=!1}else if(A.asExpandedGroups.constructor==Array){for(var F=0;F<A.asExpandedGroups.length&&(y.push(o(A.asExpandedGroups[F])),!A.bExpandSingleGroup);F++);z=!1}}else A.asExpandedGroups=new Array,A.bAddAllGroupsAsExpanded=!0;if(A.bExpandSingleGroup){var G=a("tbody tr",u),H=u.fnGetData(G[0],A.iGroupingColumnIndex),I=H;"year"!=A.sGroupBy&&(I=D(H));var J=o(I);A.asExpandedGroups=new Array,A.asExpandedGroups.push(J)}u.fnSetColumnVis(A.iGroupingColumnIndex,!A.bHideGroupingColumn),A.bCustomColumnOrdering&&u.fnSetColumnVis(A.iGroupingOrderByColumnIndex,!A.bHideGroupingOrderByColumn),-1!=A.iGroupingColumnIndex2&&u.fnSetColumnVis(A.iGroupingColumnIndex2,!A.bHideGroupingColumn2),A.bCustomColumnOrdering2&&u.fnSetColumnVis(A.iGroupingOrderByColumnIndex2,!A.bHideGroupingOrderByColumn2),u.fnSettings().aoDrawCallback.push({fn:t,sName:"fnRowGrouping"});var K=new Array;switch(K.push([A.iGroupingOrderByColumnIndex,A.sGroupingColumnSortDirection]),-1!=A.iGroupingColumnIndex2&&K.push([A.iGroupingOrderByColumnIndex2,A.sGroupingColumnSortDirection2]),u.fnSettings().aaSortingFixed=K,A.sGroupBy){case"name":break;case"letter":u.fnSettings().aoColumns[A.iGroupingOrderByColumnIndex].sSortDataType="rg-letter",a.fn.dataTableExt.afnSortData["rg-letter"]=function(b,c){var d=[];return a("td:eq("+c+")",b.oApi._fnGetTrNodes(b)).each(function(){d.push(l(this.innerHTML))}),d};break;case"year":u.fnSettings().aoColumns[A.iGroupingOrderByColumnIndex].sSortDataType="rg-date",a.fn.dataTableExt.afnSortData["rg-date"]=function(a,b){var c=[],d=a.oApi._fnGetTrNodes(a);for(F=0;F<d.length;F++)c.push(j(u.fnGetData(d[F],b)));return c}}A.bUseFilteringForGrouping&&a.fn.dataTableExt.afnFiltering.push(p),u.fnDraw()})}}(jQuery);