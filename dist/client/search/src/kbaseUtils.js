define(["q"],function(a){"use strict";var b=Object.create({},{version:{value:"0.0.2",writable:!1},getProp:{value:function(a,b,c){if("string"==typeof b)b=b.split(".");else if(!(b instanceof Array))throw new TypeError("Invalid type for key: "+typeof b);var d;for(d=0;d<b.length;d+=1){if(void 0===a||"object"!=typeof a||null===a)return c;a=a[b[d]]}return void 0===a?c:a}},hasProp:{value:function(a,b){"string"==typeof b&&(b=b.split("."));var c;for(c=0;c<b.length;c+=1){if(void 0===a||"object"!=typeof a||null===a)return!1;a=a[b[c]]}return void 0===a?!1:!0}},setProp:{value:function(a,b,c){if("string"==typeof b&&(b=b.split(".")),0!==b.length){for(var d,e=b.pop();b.length>0;)d=b.shift(),void 0===a[d]&&(a[d]={}),a=a[d];return a[e]=c,c}}},incrProp:{value:function(a,b,c){if("string"==typeof b&&(b=b.split(".")),0!==b.length){c=void 0===c?1:c;for(var d,e=b.pop();b.length>0;)d=b.shift(),void 0===a[d]&&(a[d]={}),a=a[d];if(void 0===a[e])a[e]=c;else{if("number"!=typeof a[e])throw new Error("Can only increment a number");a[e]+=c}return a[e]}}},deleteProp:{value:function(a,b){if("string"==typeof b&&(b=b.split(".")),0!==b.length){for(var c,d=b.pop();b.length>0;){if(c=b.shift(),void 0===a[c])return!1;a=a[c]}return delete a[d],!0}}},promise:{value:function(b,c,d){return a.Promise(function(a,e){if(!b[c])throw new TypeError('Invalid KBase Client call; method "'+c+'" not found in client "'+b.constructor+'"');b[c](d,function(b){a(b)},function(a){e(a)})})}},getSchemaNode:{value:function(a,b){var c,d=b.split(".");for(c=0;c<d.length;c+=1){var e=d[c];switch(a.type){case"object":var f=a.properties[e];if(!f)throw"Field "+e+" in "+b+" not found.";a=f;break;case"string":case"integer":case"boolean":default:throw"Cannot get a node on type type "+a.type}}return a}},isBlank:{value:function(a){if(void 0===a)return!0;if("object"==typeof a){if(null===a)return!0;if(a.push&&a.pop){if(0===a.length)return!0}else if(0===Object.getOwnPropertyNames(a).length)return!0}else if("string"==typeof a&&0===a.length)return!0;return!1}},merge:{value:function(a,b){var c={init:function(a){return this.dest=a,this},getType:function(a){var b=typeof a;return"object"===b?null===a?"null":a.pop&&a.push?"array":"object":b},merge:function(a,b){switch(this.dest=a,this.getType(b)){case"string":case"integer":case"boolean":case"null":throw new TypeError("Can't merge a '"+typeof b+"'");case"object":return this.mergeObject(b);case"array":return this.mergeArray(b);default:throw new TypeError("Can't merge a '"+typeof b+"'")}},mergeObject:function(a){for(var b=Object.keys(a),d=0;d<b.length;d++){var e=b[d],f=a[e],g=this.getType(f);switch(g){case"string":case"number":case"boolean":case"null":this.dest[e]=f;break;case"object":this.dest[e]||(this.dest[e]={}),this.dest[e]=Object.create(c).init(this.dest[e]).mergeObject(a[e]);break;case"array":this.dest[e]?this.dest[e]=[]:this.dest[e]=[],this.dest[e]=Object.create(c).init(this.dest[e]).mergeArray(a[e]);break;case"undefined":this.dest[e]&&delete this.dest[e]}}return this.dest},mergeArray:function(a){for(var b=!1,d=0;d<a.length;d++){var e=a[d],f=this.getType(e);switch(f){case"string":case"number":case"boolean":case"null":this.dest[d]=e;break;case"object":this.dest[d]||(this.dest[d]={}),this.dest[d]=Object.create(c).init(this.dest[d]).mergeObject(a[d]);break;case"array":this.dest[d]||(this.dest[d]=[]),this.dest[d]=Object.create(c).init(this.dest[d]).mergeArray(a[d]);break;case"undefined":this.dest[d]&&(this.dest[d]=void 0)}}return b?this.dest.filter(function(a){return void 0===a?!1:!0}):this.dest}};return Object.create(c).merge(a,b)}},iso8601ToDate:{value:function(a){if(!a)return null;var b=/(\d\d\d\d)-(\d\d)-(\d\d)T(\d\d):(\d\d):(\d\d)([\+\-])(\d\d)(:?[\:]*)(\d\d)/,c=b.exec(a);if(!c)throw new TypeError("Invalid Date Format for "+a);var d=c[7]+c[8]+":"+c[10],e=c[1]+"-"+c[2]+"-"+c[3]+"T"+c[4]+":"+c[5]+":"+c[6]+d;return new Date(e)}},niceElapsedTime:{value:function(a,b){if("string"==typeof a)var c=new Date(a);else if("number"==typeof a)var c=new Date(a);else var c=a;if(void 0===b)var d=new Date;else if("string"==typeof b)var d=new Date(b);else var d=b;var e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=Math.round((d.getTime()-c.getTime())/1e3),g=Math.abs(f);if(604800>g){if(0===g)return"now";if(60>g)var h=f,i=g,j="second";else if(3600>g)var h=Math.round(f/60),i=Math.round(g/60),j="minute";else if(86400>g)var h=Math.round(f/3600),i=Math.round(g/3600),j="hour";else if(604800>g)var h=Math.round(f/86400),i=Math.round(g/86400),j="day";i>1&&(j+="s");var k=null,l=null;if(0>h)var k="in";else if(h>0)var l="ago";return(k?k+" ":"")+i+" "+j+(l?" "+l:"")}return d.getFullYear()===c.getFullYear()?e[c.getMonth()]+" "+c.getDate():e[c.getMonth()]+" "+c.getDate()+", "+c.getFullYear()}},niceTimestamp:{value:function(a){if("string"==typeof a)var b=new Date(a);else if("number"==typeof a)var b=new Date(a);else var b=a;var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=b.getMinutes();if(10>d&&(d="0"+d),b.getHours()>=12)if(12!==b.getHours())var e=b.getHours()-12+":"+d+"pm";else var e="12:"+d+"pm";else var e=b.getHours()+":"+d+"am";var f=c[b.getMonth()]+" "+b.getDate()+", "+b.getFullYear()+" at "+e;return f}},fileSizeFormat:{value:function(a){if("string"==typeof a)var a=parseInt(a);for(var b=[];a>0;){var c=a%1e3;b.unshift(c+""),a=Math.floor(a/1e3),a>0&&b.unshift(",")}return b.join("")+" bytes"}},getJSON:{value:function(b,c){return a($.ajax(b,{type:"GET",dataType:"json",timeout:c||1e4}))}},object_to_array:{value:function(a,b,c){var d=Object.keys(a),e=[];for(var f in d){var g={};g[b]=d[f],g[c]=a[d[f]],e.push(g)}return e}},mapAnd:{value:function(a,b){for(var c=(Object.keys(a[0]),0);c<a[0].length;c++)for(var d=[],e=0;e<a.length;e++)if(d.push(a[e][c]),!b.call(null,d))return!1;return!0}},isEqual:{value:function(a,b){var c=[],d=function(a,b){var e=typeof a,f=typeof b;if(e!==f)return!1;switch(e){case"string":case"number":case"boolean":if(a!==b)return!1;break;case"undefined":if("undefined"!==f)return!1;break;case"object":if(a instanceof Array){if(a.length!==b.length)return!1;for(var g=0;g<a.length;g++){if(c.push(g),!d(a[g],b[g]))return!1;c.pop()}}else if(null===a){if(null!==b)return!1}else{if(null===b)return!1;var h=Object.keys(a),i=Object.keys(b);if(h.length!==i.length)return!1;for(var g=0;g<h.length;g++){if(c.push(h[g]),!d(a[h[g]],b[h[g]]))return!1;c.pop()}}}return!0}.bind(this);return d(a,b)}}});return b});