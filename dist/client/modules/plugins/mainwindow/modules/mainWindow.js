define(["bluebird","kb/common/dom","kb/common/html","kb/widget/widgetSet"],function(a,b,c,d){"ust strict";function e(e){function f(b){return new a(function(a){a()})}function g(){var a=c.tag("div"),b=a({style:{position:"relative",height:"100%"},"class":"kb-widget-mainWindow"},[a({style:{"border-right":"0px #EEE solid",padding:"4px",display:"inline-block",height:"100%",verticalAlign:"top"}},[a({id:r.addWidget("menu")})]),a({style:{"border-right":"0px #EEE solid",padding:"4px",display:"inline-block",height:"100%",verticalAlign:"top"}},a({id:r.addWidget("logo")})),a({style:{display:"inline-block",padding:"4px",height:"100%",verticalAlign:"top"}},[a({id:r.addWidget("title")})]),a({style:{position:"absolute",right:"0",top:"0",bottom:"0",verticalAlign:"top"}},[a({style:{borderLeft:"0px #EEE solid",display:"inline-block",padding:"4px",height:"100%",verticalAlign:"top"}},[a({id:r.addWidget("buttonbar")})]),a({style:{borderLeft:"0px #EEE solid",borderRight:"0px #EEE solid",padding:"4px",display:"inline-block",height:"100%",verticalAlign:"top",width:"100px"}},[a({id:r.addWidget("notification")})]),a({style:{padding:"4px",display:"inline-block",height:"100%"},"class":"navbar-right"},[a({id:r.addWidget("login")})])])]);return b}function h(){var a=c.tag("div");return a({id:"wrap"},[a({id:"content"},[a({"class":"navbar navbar-kbase navbar-fixed-top",id:"kbase-navbar",style:"padding: 0"},g()),a({"class":"kb-mainwindow-body",style:{"padding-top":"1em"}},[a({id:r.addWidget("body")})])])])}function i(c){return new a(function(a){o=c,p=b.createElement("div"),o.appendChild(p),a()})}function j(b){return new a(function(a,c){p.innerHTML=h(),r.init().then(function(){return r.attach(p)}).then(function(){return r.start(b)}).then(function(){}).then(function(){a()})["catch"](function(a){c(a)})})}function k(b){return new a(function(a,c){r.run(b).then(function(){a()})["catch"](function(a){c(a)})})}function l(){return new a(function(a){r.stop().then(function(){a()})["catch"](function(a){reject(a)})})}function m(){return new a(function(a){r.detach().then(function(){o.removeChild(p),a()})["catch"](function(a){reject(a)})})}function n(){return new a(function(a){r.destroy().then(function(){a()})["catch"](function(a){reject(a)})})}var o,p,q=e.runtime,r=d.make({runtime:q});return{init:f,attach:i,start:j,run:k,stop:l,detach:m,destroy:n}}return{make:function(a){return e(a)}}});