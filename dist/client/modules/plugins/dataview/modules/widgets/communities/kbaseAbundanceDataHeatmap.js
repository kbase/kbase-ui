define(["jquery","bluebird","kb/service/client/workspace","kb/common/html","kb_dataview_communities_heatmap","datatables_bootstrap","kb/widget/legacy/authenticatedWidget"],function(a,b,c,d,e){"use strict";a.KBWidget({name:"AbundanceDataHeatmap",parent:"kbaseAuthenticatedWidget",version:"1.0.0",token:null,options:{id:null,ws:null,rows:0},init:function(a){return this._super(a),this},render:function(){var b=this,f=this.$elem;if(f.empty(),!this.runtime.service("session").isLoggedIn())return void f.append("<div>[Error] You're not logged in</div>");f.append(d.loading("loading data..."));var g=new c(this.runtime.getConfig("services.workspace.url"),{token:this.runtime.service("session").getAuthToken()});return g.get_objects([{ref:b.options.ws+"/"+b.options.id}],function(c){if(f.empty(),0===c.length){var g="[Error] Object "+b.options.id+" does not exist in workspace "+b.options.ws;f.append("<div><p>"+g+">/p></div>")}else{var h=c[0].data,i=d.genId();f.append("<div id='outputHeatmap"+i+"' style='width: 95%;'></div>");var j=e.create({target:a("#outputHeatmap"+i).get(0),data:h});j.render()}},function(b){f.empty();var c=a("<div>");c.append(a("<p>").css({padding:"10px 20px"}).text("[Error] "+b.error.message)),f.append(c)}),b},loggedInCallback:function(a,b){return this.token=b.token,this.render(),this},loggedOutCallback:function(a,b){return this.token=null,this.render(),this}})});