define(["bluebird","kb/common/html","kb/widget/widgetSet"],function(a,b,c){"use strict";function d(d){function e(c){return new a(function(a){var c=b.tag("div"),d=c({"class":"kbase-view kbase-user-page-view container-fluid","data-kbase-view":"social"},[c({"class":"row"},[c({"class":"col-sm-9"},[c({id:m.addWidget("kb_userProfile_profileEditor")})]),c({"class":"col-sm-3"},[c({id:m.addWidget("kb_userProfile_userSearch")})])]),c({"class":"row"},[c({"class":"col-sm-6"},[c({id:m.addWidget("kb_userProfile_narrativeBrowser")})]),c({"class":"col-sm-6"},[c({id:m.addWidget("kb_userProfile_collaboratorNetwork")})])])]);a({title:l.service("session").getUsername(),content:d})})}function f(b){return a["try"](function(){return j=b,k=document.createElement("div"),j.appendChild(k),e().then(function(a){return k.innerHTML=a.content,l.send("ui","setTitle",a.title),m.init()}).then(function(){return m.attach(k)})})}function g(a){return m.start(a)}function h(){return m.stop()}function i(){return m.detach()}var j,k,l=d.runtime,m=c.make({runtime:l});return{attach:f,start:g,stop:h,detach:i}}return{make:function(a){return d(a)}}});