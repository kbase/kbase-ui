define(["bluebird"],function(a){"use strict";function b(b){function c(a,b){k[a]={config:b}}function d(b){return new a(function(a){var c=k[b],d=c.config.module;if(d)console.log("appServiceManager: have a module already."),console.log(d);else{d="kb_appServices_"+b;var e={},f=k[b].config.path||"app/services/"+b;e[d]=f,require.config({paths:e})}require([d],function(c){var d=c.make(k[b].config);k[b].instance=d,a()})})}function e(){var b=Object.keys(k).map(function(a){return d(a)});return a.all(b)}function f(){var b=Object.keys(k).map(function(b){return a["try"](function(){var c=k[b].instance;if(!c)throw console.warn("Warning: no service started for "+b),new Error("No service started for "+b);return c.start?a["try"](function(){return c.start()}):void console.warn("Warning: no start method for "+b)})});return a.all(b)}function g(){var b=Object.keys(k).map(function(b){return new a(function(a){var c=k[b];return c&&c.instance&&c.instance.stop?c.instance.stop().then(function(){a()}):void 0})});return a.all(b)}function h(a){return k[a]?!0:!1}function i(a){var b=k[a];if(!b)throw{name:"UndefinedService",message:'The requested service "'+a+'" has not been registered.',suggestion:"This is a system configuration issue. The requested service should be installed or the client code programmed to check for its existence first (with hasService)"};return b.instance}function j(){return k}var k={};return{addService:c,getService:i,loadService:d,hasService:h,loadServices:e,startServices:f,stopServices:g,dumpServices:j}}return{make:function(a){return b(a)}}});